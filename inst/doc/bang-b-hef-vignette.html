<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul Northrop" />

<meta name="date" content="2023-12-02" />

<title>Conjugate Hierarchical Models</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Conjugate Hierarchical Models</h1>
<h4 class="author">Paul Northrop</h4>
<h4 class="date">2023-12-02</h4>


<div id="TOC">
<ul>
<li><a href="#beta-binomial-model" id="toc-beta-binomial-model">Beta-binomial model</a></li>
<li><a href="#gamma-poisson-model" id="toc-gamma-poisson-model">Gamma-Poisson Model</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>The <em>bang</em> package simulates from the posterior distributions
involved in certain Bayesian models. See the vignette <a href="bang-a-vignette.html">Introducing bang: Bayesian Analysis, No
Gibbs</a> for an introduction. In this vignette we consider the Bayesian
analysis of certain conjugate hierarchical models. We give only a brief
outline of the structure of these models. For a full description see
Chapter 5 of <span class="citation">Gelman et al. (2014)</span>.</p>
<p>Suppose that, for <span class="math inline">\(j = 1, \ldots,
J\)</span>, experiment <span class="math inline">\(j\)</span> of <span class="math inline">\(J\)</span> experiments yields a data vector <span class="math inline">\(Y_j\)</span> and associated parameter vector <span class="math inline">\(\theta_j\)</span>. Conditional on <span class="math inline">\(\theta_j\)</span> the data <span class="math inline">\(Y_j\)</span> are assumed to follow independent
response distributions from the exponential family of probability
distributions. A prior distribution <span class="math inline">\(\pi(\theta_j \mid \phi)\)</span> is placed on each
of the <em>population parameters</em> <span class="math inline">\(\theta_1, \ldots, \theta_J\)</span>, where <span class="math inline">\(\phi\)</span> is a vector of hyperparameters. For
mathematical convenience <span class="math inline">\(\pi(\theta_j \mid
\phi)\)</span> is selected to be <em>conditionally conjugate</em>, that
is, conditionally on <span class="math inline">\(\phi\)</span> the
posterior distribution of <span class="math inline">\(\theta_j\)</span>
of the same type as <span class="math inline">\(\pi(\theta_j \mid
\phi)\)</span>.</p>
<p>Use of a conditionally conjugate prior means that it is possible to
derive, and simulate from, the marginal posterior density <span class="math inline">\(\pi(\phi \mid \boldsymbol{\mathbf{y}})\)</span>.
The <code>hef</code> function does this using the generalized
ratio-of-uniforms method, implemented by the function <code>ru</code> in
the <em>rust</em> package <span class="citation">(Northrop
2017)</span>). By default a model-specific transformation of the
parameter vector <span class="math inline">\(\phi\)</span> is used to
improve efficiency. See the documentation of <code>hef</code> and the
two examples below for details. Simulation from the full posterior
density <span class="math inline">\(\pi(\boldsymbol{\mathbf{\theta}},
\phi \mid \boldsymbol{\mathbf{y}}) = \pi(\boldsymbol{\mathbf{\theta}}
\mid \phi, \boldsymbol{\mathbf{y}}) \pi(\phi \mid
\boldsymbol{\mathbf{y}})\)</span> follows directly because conditional
conjugacy means that it is simple to simulate from <span class="math inline">\(\pi(\boldsymbol{\mathbf{\theta}} \mid \phi,
\boldsymbol{\mathbf{y}})\)</span>, given the values simulated from <span class="math inline">\(\pi(\phi \mid \boldsymbol{\mathbf{y}})\)</span>.
The simulation is performed in the function <code>hef</code>.</p>
<div id="beta-binomial-model" class="section level2">
<h2>Beta-binomial model</h2>
<p>We consider the example presented in Section 5.3 of <span class="citation">Gelman et al. (2014)</span>, in which the data <span class="citation">(Tarone 1982)</span> in the matrix <code>rat</code> are
analysed. These data contain information about an experiment in which,
for each of 71 groups of rats, the total number of rats in the group and
the numbers of rats who develop a tumor is recorded, so that <span class="math inline">\(J = 71\)</span>. Conditional on <span class="math inline">\(\boldsymbol{\mathbf{\theta}} = (\theta_1, \ldots,
\theta_J) = (p_1, \ldots, p_J)\)</span> we assume independent binomial
distributions for <span class="math inline">\((Y_1, \ldots,
Y_J)\)</span>, that is, <span class="math inline">\(Y_j \sim {\rm
binomial}(n_j, p_j)\)</span>. We use the conditionally conjugate priors
<span class="math inline">\(p_j \sim {\rm Beta}(\alpha, \beta)\)</span>,
so that <span class="math inline">\(\phi = (\alpha, \beta)\)</span>.</p>
<p>The conditional conjagacy of the priors means that the marginal
posterior of <span class="math inline">\((\alpha, \beta)\)</span> given
<span class="math inline">\(\boldsymbol{\mathbf{y}} = (y_1, \ldots,
y_J)\)</span> can be determined (equation (5.8) of <span class="citation">Gelman et al. (2014)</span>) as <span class="math display">\[ \pi(\alpha, \beta \mid \boldsymbol{\mathbf{y}})
\propto \pi(\alpha, \beta)
\prod_{j=1}^J \frac{B(\alpha + y_j, \beta + n_j - y_j)}{B(\alpha,
\beta)}, \]</span> where <span class="math inline">\(\pi(\alpha,
\beta)\)</span> is the hyperprior density for <span class="math inline">\((\alpha, \beta)\)</span>. By default <span class="math inline">\(\phi = (\alpha, \beta)\)</span> is transformed
prior to sampling using <span class="math inline">\((\rho_1,
\rho_2)=(\log (\alpha/\beta), \log (\alpha+\beta))\)</span>. The aim of
this is to improve efficiency by rotating and scaling the
(mode-relocated) conditional posterior density in an attempt to produce
near circularity of this density’s contours.</p>
<p>To simulate from the full posterior density <span class="math inline">\(\pi(\boldsymbol{\mathbf{\theta}}, \alpha, \beta
\mid \boldsymbol{\mathbf{y}}) = \pi(\boldsymbol{\mathbf{\theta}} \mid
\alpha, \beta, \boldsymbol{\mathbf{y}}) \pi(\alpha, \beta \mid
\boldsymbol{\mathbf{y}})\)</span> we first sample from <span class="math inline">\(\pi(\alpha, \beta \mid
\boldsymbol{\mathbf{y}})\)</span>. Simulation from the conditional
posterior distribution of <span class="math inline">\(\boldsymbol{\mathbf{\theta}}\)</span> given <span class="math inline">\((\alpha, \beta, \boldsymbol{\mathbf{y}})\)</span>
is then straightforward on noting that <span class="math display">\[
\theta_j \mid \alpha, \beta, y_j \sim {\rm beta}(\alpha + y_j, \beta +
n_j - y_j) \]</span> and that <span class="math inline">\(\theta_j, j =
1, \ldots, J\)</span> are conditionally independent.</p>
<p>The hyperprior for <span class="math inline">\((\alpha,
\beta)\)</span> used by default in <code>hef</code> is <span class="math inline">\(\pi(\alpha, \beta) \propto (\alpha+\beta)^{-5/2},
\alpha&gt;0, \beta&gt;0\)</span>, following Section 5.3 of <span class="citation">Gelman et al. (2014)</span>. A user-defined prior may
be set using <code>set_user_prior</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(bang)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># Default prior, sampling on (rotated) (log(mean), log(alpha + beta)) scale</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>rat_res <span class="ot">&lt;-</span> <span class="fu">hef</span>(<span class="at">model =</span> <span class="st">&quot;beta_binom&quot;</span>, <span class="at">data =</span> rat, <span class="at">n =</span> <span class="dv">10000</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">plot</span>(rat_res)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">plot</span>(rat_res, <span class="at">ru_scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>The plot on the left shows the values sampled from the posterior
distribution of <span class="math inline">\((\alpha, \beta)\)</span>
with superimposed density contours. On the right is a similar plot
displayed on the scale used for sampling, that is, <span class="math inline">\((\rho_1, \rho_2)\)</span>.</p>
<p>The following summary is of properties of the generalized ratio-of
uniforms algorithm, in particular the probability of acceptance, and
summary statistics of the posterior sample of <span class="math inline">\((\alpha, \beta)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">summary</span>(rat_res)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; ru bounding box:  </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;                box       vals1       vals2 conv</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; a        1.0000000  0.00000000  0.00000000    0</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; b1minus -0.2382163 -0.40313465 -0.03906170    0</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; b2minus -0.2174510  0.05447431 -0.35297539    0</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; b1plus   0.2231876  0.36718396 -0.06551365    0</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; b2plus   0.2512577  0.05665707  0.44459818    0</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; estimated probability of acceptance:  </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; [1] 0.5258729</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; sample summary </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;      alpha              beta       </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  Min.   : 0.6152   Min.   : 3.883  </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 1.7895   1st Qu.:10.675  </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;  Median : 2.2198   Median :13.329  </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  Mean   : 2.4051   Mean   :14.341  </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 2.8034   3rd Qu.:16.830  </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;  Max.   :14.1474   Max.   :80.895</span></span></code></pre></div>
</div>
<div id="gamma-poisson-model" class="section level2">
<h2>Gamma-Poisson Model</h2>
<p>We perform a fully Bayesian analysis of an empirical Bayesian example
presented in Section 4.2 of <span class="citation">Gelfand and Smith
(1990)</span>, who fix the hyperparameter <span class="math inline">\(\alpha\)</span> described below at a point
estimate derived from the data. The <code>pump</code> dataset <span class="citation">(Gaver and O’Muircheartaigh 1987)</span> is a matrix in
which each row gives information about one of 10 different pump systems.
The first column contains the number of pump failures. The second column
contains the length of operating time, in thousands of hours.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>pump</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;       failures    time</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;  [1,]        5  94.320</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;  [2,]        1  15.720</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;  [3,]        5  62.880</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;  [4,]       14 125.760</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;  [5,]        3   5.240</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  [6,]       19  31.440</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  [7,]        1   1.048</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  [8,]        1   1.048</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  [9,]        4   2.096</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; [10,]       22  10.480</span></span></code></pre></div>
<p>The general setup is similar to the beta-binomial model described
above but now the response distribution is taken to be Poisson, the
prior distribution is gamma and <span class="math inline">\(J =
10\)</span>. For <span class="math inline">\(j = 1, \ldots, J\)</span>
let <span class="math inline">\(Y_j\)</span> denote the number of
failures and <span class="math inline">\(e_j\)</span> the length of
operating time for pump system <span class="math inline">\(j\)</span>.
Conditional on <span class="math inline">\(\boldsymbol{\mathbf{\lambda}}
= (\lambda_1, \ldots, \lambda_J)\)</span> we assume independent Poisson
distributions for <span class="math inline">\((Y_1, \ldots,
Y_J)\)</span> with means that are proportional to the <em>exposure</em>
time <span class="math inline">\(e_j\)</span>, that is, <span class="math inline">\(Y_j \sim {\rm Poisson}(e_j \lambda_j)\)</span>. We
use the conditionally conjugate priors <span class="math inline">\(\lambda_j \sim {\rm gamma}(\alpha,
\beta)\)</span>, so that <span class="math inline">\(\phi = (\alpha,
\beta)\)</span>. We use the parameterization where <span class="math inline">\(\beta\)</span> is a rate parameter, so that <span class="math inline">\({\rm E}(\lambda_j) = \alpha/\beta\)</span> <em>a
priori</em>.</p>
<p>The marginal posterior of <span class="math inline">\((\alpha,
\beta)\)</span> given <span class="math inline">\(\boldsymbol{\mathbf{y}} = (y_1, \ldots,
y_J)\)</span> can be determined as <span class="math display">\[
\pi(\alpha, \beta \mid \boldsymbol{\mathbf{y}}) \propto \pi(\alpha,
\beta)
\prod_{j=1}^J \frac{\beta^\alpha\Gamma(\alpha +
y_j)}{(\beta+e_j)^{\alpha+y_j} \Gamma(\alpha)},
\]</span> where <span class="math inline">\(\pi(\alpha, \beta)\)</span>
is the hyperprior density for <span class="math inline">\((\alpha,
\beta)\)</span>. The scale used for sampling is <span class="math inline">\((\rho_1, \rho_2)=(\log (\alpha/\beta), \log
\beta))\)</span>.</p>
<p>To simulate from the full posterior <span class="math inline">\(\pi(\boldsymbol{\mathbf{\lambda}}, \alpha, \beta
\mid \boldsymbol{\mathbf{y}}) = \pi(\boldsymbol{\mathbf{\lambda}} \mid
\alpha, \beta, \boldsymbol{\mathbf{y}}) \pi(\alpha, \beta \mid
\boldsymbol{\mathbf{y}})\)</span> we first sample from <span class="math inline">\(\pi(\alpha, \beta \mid
\boldsymbol{\mathbf{y}})\)</span> and then note that <span class="math display">\[ \lambda_j \mid \alpha, \beta, y_j \sim {\rm
gamma}(\alpha + y_j, \beta + e_j) \]</span> and that <span class="math inline">\(\lambda_j, j = 1, \ldots, J\)</span> are
conditionally independent.</p>
<p>By default <code>hef</code> takes <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> to be independent gamma random
variables <em>a priori</em>. The parameters of these gamma distributions
can be set by the user, using the argument <code>hpars</code> or a
different prior may be set using <code>set_user_prior</code>.</p>
<p>We produce similar output to the beta-binomial example above.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>pump_res <span class="ot">&lt;-</span> <span class="fu">hef</span>(<span class="at">model =</span> <span class="st">&quot;gamma_pois&quot;</span>, <span class="at">data =</span> pump, <span class="at">hpars =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="dv">1</span>, <span class="fl">0.01</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">plot</span>(pump_res)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">plot</span>(pump_res, <span class="at">ru_scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">summary</span>(pump_res)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; ru bounding box:  </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;                box       vals1       vals2 conv</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; a        1.0000000  0.00000000  0.00000000    0</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; b1minus -0.5174980 -0.91869101 -0.06060116    0</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; b2minus -0.5150835  0.15757254 -0.92429417    0</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; b1plus   0.4124640  0.65433383 -0.11046433    0</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; b2plus   0.4224941  0.08788857  0.67847965    0</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; estimated probability of acceptance:  </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; [1] 0.5094244</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; sample summary </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt;      alpha             beta        </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.2007   Min.   :0.08544  </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:0.8185   1st Qu.:1.29559  </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt;  Median :1.0598   Median :1.94558  </span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;  Mean   :1.1496   Mean   :2.16025  </span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:1.3915   3rd Qu.:2.73560  </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt;  Max.   :3.6629   Max.   :9.28544</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-GoM1987" class="csl-entry">
Gaver, Donald P., and I. G. O’Muircheartaigh. 1987. <span>“Robust
Empirical Bayes Analyses of Event Rates.”</span> <em>Technometrics</em>
29 (1): 1–15. <a href="https://doi.org/10.2307/2530304">https://doi.org/10.2307/2530304</a>.
</div>
<div id="ref-GS1990" class="csl-entry">
Gelfand, Alan E., and Adrian F. M. Smith. 1990. <span>“Sampling-Based
Approaches to Calculating Marginal Densities.”</span> <em>Journal of the
American Statistical Association</em> 85 (410): 398–409. <a href="https://doi.org/10.2307/2289776">https://doi.org/10.2307/2289776</a>.
</div>
<div id="ref-BDA2014" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D.
B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. Florida, USA:
Chapman &amp; Hall / CRC. <a href="http://www.stat.columbia.edu/~gelman/book/">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-rust" class="csl-entry">
Northrop, P. J. 2017. <em><span class="nocase">r</span>ust:
Ratio-of-Uniforms Simulation with Transformation</em>. <a href="https://CRAN.R-project.org/package=rust">https://CRAN.R-project.org/package=rust</a>.
</div>
<div id="ref-Tarone1982" class="csl-entry">
Tarone, Robert E. 1982. <span>“The Use of Historical Control Information
in Testing for a Trend in Proportions.”</span> <em>Biometrics</em> 38
(1): 215–20. <a href="https://doi.org/10.2307/1269878">https://doi.org/10.2307/1269878</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

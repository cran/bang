<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul J. Northrop" />

<meta name="date" content="2024-07-17" />

<title>Hierarchical 1-way Analysis of Variance</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Hierarchical 1-way Analysis of
Variance</h1>
<h4 class="author">Paul J. Northrop</h4>
<h4 class="date">2024-07-17</h4>


<div id="TOC">
<ul>
<li><a href="#late-21st-century-global-temperature-projection-data" id="toc-late-21st-century-global-temperature-projection-data">Late 21st
Century Global Temperature Projection Data</a></li>
<li><a href="#coagulation-time-data" id="toc-coagulation-time-data">Coagulation time data</a></li>
<li><a href="#appendix" id="toc-appendix">Appendix</a>
<ul>
<li><a href="#marginal-posterior-density-of-boldsymbolmathbfphi" id="toc-marginal-posterior-density-of-boldsymbolmathbfphi">Marginal
posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span></a></li>
<li><a href="#the-conditional-posterior-density-of-boldsymbolmathbftheta-given-boldsymbolmathbfphi" id="toc-the-conditional-posterior-density-of-boldsymbolmathbftheta-given-boldsymbolmathbfphi">The
conditional posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\theta}}\)</span> given <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span></a></li>
<li><a href="#factorisations-for-simulation" id="toc-factorisations-for-simulation">Factorisations for
simulation</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>The <em>bang</em> package simulates from the posterior distributions
involved in certain Bayesian models. See the vignette <a href="bang-a-vignette.html">Introducing bang: Bayesian Analysis, No
Gibbs</a> for an introduction. In this vignette we consider the
hierarchical 1-way Analysis of variance (ANOVA) model: <span class="math display">\[\begin{equation*}
Y_{ij} = \mu + \alpha_i + \epsilon_{ij} = \theta_i + \epsilon_{ij},
\quad\mbox{for} \,\, i = 1, \ldots, I, \, j = 1, \ldots, n_i,
\end{equation*}\]</span> where <span class="math inline">\(\alpha_i \sim
N(0, \sigma_\alpha^2)\)</span>, so that <span class="math inline">\(\theta_i = \mu + \alpha_i \sim N(\mu,
\sigma_\alpha^2)\)</span>, and <span class="math inline">\(\epsilon_{ij}
\sim N(0, \sigma^2)\)</span> and all random variables are independent.
Variability of the response variable <span class="math inline">\(Y\)</span> about an overall level <span class="math inline">\(\mu\)</span> is decomposed into contributions
<span class="math inline">\(\alpha_i, i = 1, \ldots, I\)</span> from an
explanatory factor indicating membership of group <span class="math inline">\(i\)</span> and a random error term <span class="math inline">\(\epsilon_{ij}\)</span>.</p>
<p>This model has <span class="math inline">\(I + 3\)</span> parameters:
<span class="math inline">\(\boldsymbol{\mathbf{\phi}} = (\mu,
\sigma_\alpha, \sigma)\)</span> and <span class="math inline">\(\boldsymbol{\mathbf{\alpha}} = (\alpha_1, \ldots,
\alpha_I)\)</span>. Equivalently, we could replace <span class="math inline">\(\boldsymbol{\mathbf{\alpha}}\)</span> by <span class="math inline">\(\boldsymbol{\mathbf{\theta}} = (\theta_1, \ldots,
\theta_I)\)</span>. The full posterior <span class="math inline">\(\pi(\boldsymbol{\mathbf{\alpha}},\boldsymbol{\mathbf{\phi}}
\mid \boldsymbol{\mathbf{y}}) = \pi(\boldsymbol{\mathbf{\alpha}} \mid
\boldsymbol{\mathbf{\phi}}, \boldsymbol{\mathbf{y}}) \,
\pi(\boldsymbol{\mathbf{\phi}} \mid \boldsymbol{\mathbf{y}})\)</span>
can be factorized into products of lower-dimensional densities. See the
<a href="#appendix">Appendix</a> for details. If it is assumed that
<span class="math inline">\(\mu\)</span> and <span class="math inline">\((\sigma_\alpha, \sigma)\)</span> are independent
<em>a priori</em> and a normal prior is set for <span class="math inline">\(\mu\)</span> then the only challenging part of
sampling from <span class="math inline">\(\pi(\boldsymbol{\mathbf{\alpha}},\boldsymbol{\mathbf{\phi}}
\mid \boldsymbol{\mathbf{y}})\)</span> is to simulate from the
two-dimensional density <span class="math inline">\(\pi(\sigma_\alpha,
\sigma \mid \boldsymbol{\mathbf{y}})\)</span>. Otherwise, we need to
simulate from <span class="math inline">\(\pi(\mu, \sigma_\alpha, \sigma
\mid \boldsymbol{\mathbf{y}})\)</span>. The <em>bang</em> function
<code>hanova1</code> uses the <em>rust</em> package <span class="citation">(Northrop 2017)</span> to simulate from these
densities. In sampling from the marginal posterior density <span class="math inline">\(\pi(\phi \mid \boldsymbol{\mathbf{y}})\)</span> we
use a parameterization designed to improve the efficiency of sampling.
In this case we work with <span class="math inline">\((\log\sigma_\alpha, \log\sigma)\)</span>. We
illustrate the use of <code>hanova1</code> using two example datasets.
Unless stated otherwise we use the default hyperprior <span class="math inline">\(\pi(\mu, \sigma_\alpha, \sigma) \propto
1/\sigma\)</span>, that is, a uniform prior for <span class="math inline">\((\mu, \sigma_\alpha, \log\sigma)\)</span> for
<span class="math inline">\(\sigma_\alpha&gt;0, \sigma&gt;0\)</span>
(see Sections 5.7 and 11.6 of <span class="citation">Gelman et al.
(2014)</span>). A user-defined prior can be set using
<code>set_user_prior</code>.</p>
<div id="late-21st-century-global-temperature-projection-data" class="section level2">
<h2>Late 21st Century Global Temperature Projection Data</h2>
<p>The data frame <code>temp2</code> contains indices of global
temperature change from late 20th century (1970-1999) to late 21st
century (2069-2098) based on data produced by the Fifth Coupled Model
Intercomparison Project (CMIP5). The dataset is the union of four
subsets, each based on a different greenhouse gas emissions scenario
called a Representative Concentration Pathway (RCP). Here we analyse
only data for RCP2.6. Of course, inferences about the overall
temperature change parameter <span class="math inline">\(\mu\)</span>
are important, but it is also interesting to compare the magnitudes of
<span class="math inline">\(\sigma_\alpha\)</span> and <span class="math inline">\(\sigma\)</span>. If, for example, if <span class="math inline">\(\sigma_\alpha\)</span> is much greater than <span class="math inline">\(\sigma\)</span> then uncertainty about temperature
projection associated with choice of GCM is greater than that associated
with the choice of simulation run from a particular GCM. See <span class="citation">Northrop and Chandler (2014)</span> for more
information.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(bang)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># Extract RCP2.6 data</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>RCP26_2 <span class="ot">&lt;-</span> temp2[temp2<span class="sc">$</span>RCP <span class="sc">==</span> <span class="st">&quot;rcp26&quot;</span>, ]</span></code></pre></div>
<p>There are 61 observations in total distributed rather unevenly across
the 38 GCMs. Only 28 of the GCMs have at least one run available for
RCP2.6.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">length</span>(RCP26_2[, <span class="st">&quot;index&quot;</span>])</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; [1] 61</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Numbers of runs for each GCM</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">table</span>(RCP26_2[, <span class="st">&quot;GCM&quot;</span>])</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;      ACCESS1-0      ACCESS1-3     bcc-csm1-1   bcc-csm1-1-m        BNU-ESM </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;              0              0              1              1              1 </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;        CanESM2          CCSM4      CESM1-BGC     CESM1-CAM5        CMCC-CM </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;              5              6              0              3              0 </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;       CMCC-CMS       CNRM-CM5  CSIRO-Mk3-6-0       EC-EARTH      FGOALS-g2 </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;              0              1             10              2              1 </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;        FIO-ESM       GFDL-CM3     GFDL-ESM2G     GFDL-ESM2M      GISS-E2-H </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;              3              1              1              1              1 </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;   GISS-E2-H-CC      GISS-E2-R   GISS-E2-R-CC     HadGEM2-AO     HadGEM2-CC </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;              0              1              0              1              0 </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;     HadGEM2-ES         inmcm4   IPSL-CM5A-LR   IPSL-CM5A-MR   IPSL-CM5B-LR </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;              4              0              4              1              0 </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;      MIROC-ESM MIROC-ESM-CHEM         MIROC5     MPI-ESM-LR     MPI-ESM-MR </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt;              1              1              3              3              1 </span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;      MRI-CGCM3      NorESM1-M     NorESM1-ME </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt;              1              1              1</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Number of GCMs with at least one run</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">table</span>(RCP26_2[, <span class="st">&quot;GCM&quot;</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; [1] 28</span></span></code></pre></div>
<p>We use <code>hanova1</code> to sample from the posterior distribution
of the parameters based on the (default) improper uniform prior for
<span class="math inline">\((\mu, \log\sigma_\alpha, \sigma)\)</span>,
described in Section 11.6 of <span class="citation">Gelman et al.
(2014)</span>. This prior fits in to the special case considered in the
<a href="#appendix">Appendix</a>, with an infinite prior variance <span class="math inline">\(\sigma_0^2\)</span> for <span class="math inline">\(\mu\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># The response is the index, the explanatory factor is the GCM</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>temp_res <span class="ot">&lt;-</span> <span class="fu">hanova1</span>(<span class="at">resp =</span> RCP26_2[, <span class="st">&quot;index&quot;</span>], <span class="at">fac =</span> RCP26_2[, <span class="st">&quot;GCM&quot;</span>])</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># Plots relating to the posterior sample of the variance parameters</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">plot</span>(temp_res, <span class="at">params =</span> <span class="st">&quot;ru&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">plot</span>(temp_res, <span class="at">ru_scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUsAAAFLCAMAAABoaV6sAAABdFBMVEUAAAAAAA0AACQAACgAADoAAD8AAGYADVEAJD8AJFkAKFEAKIEAOjoAOpAAP1kAP3EAZrYNAAANAA0NACgNDVENKFENUbwkAAAkAD8kJFkkP3EkWVkkWYgoAAAoDVEoKA0ogf86AAA6ADo6Ojo6OpA6ZmY6ZpA6ZrY6kNs/AAA/ACQ/AD8/JAA/JD8/JFk/WXE/cZ5RDQBRDQ1RDShRKA1RUQ1RgVFRvP9ZJABZJCRZJD9ZP1lZWT9ZiJ5mAABmADpmAGZmOgBmOpBmZrZmtttmtv9xPwBxPyRxiJ5xnohxnp6BKACBKA2BUQ2B/7yB//+IWSSIWVmIiIiIiJ6Inp6QOgCQZgCQZjqQZmaQkDqQtv+Q2/+ecT+eiFmennGenoienp62ZgC2Zjq2tra229u22/+2/7a2//+8UQ28///bkDrbkJDbtmbbtpDb29vb/9vb////gSj/tmb/vFH/vIH/25D/29v//4H//7b//7z//9v///9DBHnHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAWzElEQVR4nO2di4Mcx1HGO47sxICxHMB5cDZWgNjBPBQZIsWgS4A4DheClSDz0qsvBBwfMdgnhE6qf56d6a7qqu7pedbkZk/12VrtzPT2Tv+2Xt0zu3Jg0pI77xO4QDKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWejKWelJm6S6izoulbnebkLHUk7EE8N6r9GMswcc/i7VXLLUMSHbKHpdpn1iqGVDR66ZZHjt3+emHuzLhPZXuWukNeqVu12F58tKnO5yXAc4O31LoLmj8oJtYMD4ebDtePv1wR/D00h0IVJd2FzWapYdpgDadx88Od659+sJHgI/LukMhn4GJRmi2TnDt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" /><img src="data:image/png;base64,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" /></p>
<p>The plot on the left shows the values sampled from the posterior
distribution of <span class="math inline">\((\sigma_\alpha,
\sigma)\)</span> with superimposed density contours. We see that the
posterior distribution is located at values for which <span class="math inline">\(\sigma_\alpha\)</span> is much greater than <span class="math inline">\(\sigma\)</span>, by a factor of nearly 10. On the
right is a similar plot displayed on the scale used for sampling, <span class="math inline">\((\rho_1, \rho_2)=(\log \sigma_\alpha, \log
\sigma)\)</span>, after relocation of the posterior mode to the origin
and rotation and scaling to near circularity of the density
contours.</p>
<p>We summarize the marginal posterior distribution of <span class="math inline">\(\mu\)</span> using a histogram with a superimposed
kernel density estimate.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">hist</span>(temp_res<span class="sc">$</span>sim_vals[, <span class="st">&quot;mu&quot;</span>],  <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(mu), <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(temp_res<span class="sc">$</span>sim_vals[, <span class="st">&quot;mu&quot;</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The following plot summarizes the estimated marginal posterior
densities of the mean index for each GCM.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(temp_res, <span class="at">params =</span> <span class="st">&quot;pop&quot;</span>, <span class="at">which_pop =</span> <span class="st">&quot;all&quot;</span>, <span class="at">one_plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="coagulation-time-data" class="section level2">
<h2>Coagulation time data</h2>
<p>In the temperature projection example sampling was conducted on the
scale <span class="math inline">\((\log\sigma_\alpha,
\log\alpha)\)</span> and was unproblematic. It would also have been
unproblematic had we sampled on the original <span class="math inline">\((\sigma_\alpha, \sigma)\)</span> scale. To show
that there are examples where the latter is not the case we consider a
small dataset presented in Section 11.6 of <span class="citation">Gelman
et al. (2014)</span>. The response variable is the coagulation time of
blood drawn from 24 animals allocated to different diets. The crucial
aspect of this dataset is that the explanatory factor (diet) has only 4
levels. This means that there is little information about <span class="math inline">\(\sigma_\alpha\)</span> in the data. Unless some
prior information about <span class="math inline">\(\sigma_\alpha\)</span> is provided the posterior
distribution for <span class="math inline">\(\sigma_\alpha\)</span> will
tend to have a heavy upper tail <span class="citation">(Gelman
2006)</span>.</p>
<p>The generalized ratio-of-uniforms method used by <em>rust</em> can
fail for heavy-tailed densities and this is indeed the case for these
data if we try to sample directly from <span class="math inline">\(\pi(\sigma_\alpha, \sigma \mid
\boldsymbol{\mathbf{y}})\)</span> using the <em>rust</em> package’s
default settings for the generalized ratio-of-uniforms algorithm. One
solution is to reparameterize to <span class="math inline">\((\log\sigma_\alpha, \log\sigma)\)</span>, which
<code>hanova1</code> implements by default. Another possibility is to
increase the generalized ratio-of-uniforms tuning parameter
<code>r</code> from the default value of 1/2 used in <em>rust</em>.
These approaches are illustrated below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>coag1 <span class="ot">&lt;-</span> <span class="fu">hanova1</span>(<span class="at">resp =</span> coagulation[, <span class="dv">1</span>], <span class="at">fac =</span> coagulation[, <span class="dv">2</span>], <span class="at">n =</span> <span class="dv">10000</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>coag2 <span class="ot">&lt;-</span> <span class="fu">hanova1</span>(<span class="at">resp =</span> coagulation[, <span class="dv">1</span>], <span class="at">fac =</span> coagulation[, <span class="dv">2</span>], <span class="at">n =</span> <span class="dv">10000</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                 <span class="at">param =</span> <span class="st">&quot;original&quot;</span>, <span class="at">r =</span> <span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">plot</span>(coag1, <span class="at">params =</span> <span class="st">&quot;ru&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">plot</span>(coag1, <span class="at">ru_scale =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUsAAAFLCAMAAABoaV6sAAABNVBMVEUAAAAAACQAACgAADoAAD8AAGYAJFkAOmYAOpAAP3EAZrYNAAANACgNDVENUbwkAAAkJFkkP3EkWXEkWYgoAAAoACgoKA0oKCgoUVEogf86AAA6ADo6AGY6Ojo6OmY6OpA6ZpA6ZrY6kNs/AAA/ACQ/AD8/JFk/PyQ/Pz8/WVk/cZ5RgVFRvP9ZJABZJD9ZWT9ZiJ5mAABmADpmAGZmOgBmOjpmkJBmkLZmtv9xPwBxPyRxcT9xiFlxnp6BKACBKA2B//+IWSSIiIiInp6QOgCQOjqQOmaQkLaQ2/+ecT+eiFmennGenoienp62ZgC2Zjq2kGa2tra229u22/+2/7a2//+8UQ28///bkDrbkGbbtmbb29vb////gSj/tmb/vFH/25D/27b/29v//4H//7b//9v///8UWxfmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQ8klEQVR4nO2dC5slNRGGg6JchAUcvA0gcvMysjqIKAuOsO6KuzMbdAVlRBgWmcn//wme7qSSSjrp7nRX+nR663ue7Zk5fcnJu5VUpZKTIxSLSmLfb2BDYpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0YpZ0ImYptqgSLC/fenV3vNg9/Tv/InhcLSrH8vzxL5rf3p3/uFpUjKWh2BKd+biEpJToxwpUjOWDw5blRaKVz2cp9T/zYw2q1i41P2OT64BZiGXj1Z5U4IVmPi6qh4WlanF++87OlSdQMst9lJvUQ9JfLvO4h8OPI50X8+Pr08J2mT/eqkgVt/HViVnSiVnSiVnSqeC4R4v9+IwLG13dTiYupzyuEhVq41e3n6R8XB0q1V9eiEQSeNrjqhD7HjoxSzptjKWf6Fg47bEtln4Cbul03KZY+olh2drlgjC3zFIqm3hfRFtmqY/L0dwUS7+HtHa5FMxtsTRWaI62v1wI5kZYei1Zun9mSqhzSRFtg6XftpVvnx7cktoEy47PsRYZYCwLc5MspT26mV/vkjLaIEvw3bLnkiLaBEvXiv8txLXmcKBCcLK889kGS+D01dOfqQ9+/fRn8oM3OzZYfkBZJcuIhenlC19eU+rPP9odbhx1UKJjIdXIMsgG7cDCMpCvnvrwm+d//NTJ2Ws/aQtB60OsJyqHs0KWnQjIApPy9Hvf+uGbzeG4dUBSGpphpFlEtbPUNgkvfXkgz37w/jX1zRsftr5GGqMNosxCtlnh2iyfpbB/7A5nz+9ceHO41vptZbjtipPStu9i6Y4K7dJrqMK80oLSdgjjHvdC09YlICyX7qiEZWIeRxhE1gSlk3u1vUS3BT/dQaw6WCYsSYABBhglEHadJrh764QK9JlVsEzEhsIm0wJzNEYZMm6sExp6ieCoYpbCslS+VXotXeFfdzeBwRaYCqqXpVC4R/QNMNHom2uFjaHILbMKlrH+0jkS1CvKqBT6ReMEf+6PnsJCc1nXwbJbL+EbZQwkREC+tWonJKFLheerzn9WfuRUCcsOTQFmheB5n4sHcNDeYSpNGo8Op/XD0VElXyKr055ZBlZiXQgm6Vml5Rlr9G28iewy0n9ul2UQFArT2yVJei/iKN5GQ+ase7zff26dpRtIC+V3lkkTRCewBzIn3Zjd9hh+kZvsL/2BtFB2yJ20SXfSP6vcfU2vicwbyrFlbtSPewNpyEha8xqQd4H3v6B0AklZLzQr4qyFJc7mCgWDwDEoFTZcf5CkE8nI8cwL3qthqWwPpls42FwEZbTfjCJvHyRcSDD+rcSurYmlqYHAKAeM0sPprBEsFMIj34WPeCMqZsNVsbR3TmHZuRjl3zJhJvNWGVUYq6L7ZtneMhel3yFg5y1NOx/bzBdnWWrfLBGgTCQ0hmnaQWTbcdjMZlOGYxqluzTLUvsTIZS5Zhne0zwODlKgANZ1hwnnvmB/WXLfLAGJtmkokTG3j7MDTBO4K9tz+kADRc21Qrs0jXMiSi/aRNNBCuY8RrGcV6c8lsX2zRITfbhPs+VnOdp8BxqbroalKrdvlnDGFGF57/ru//CJUTDRQNKCVcJOBMnQOMe8N/ILyz5O2DFgyixvPnty9toQURHSNH/YOXSbjcsYDNXHMm2V7Us3dxDvHgxapk64WUEzlzBRPGVoXpol8b5Zzmw6LLVLOX32lpTvHQ+iVEH2yLBsYK6WZfiUWWuz2sEeNsKQpJQ3jqRsmvijJ1HgsVswUj2FLiehrKqNm3rqNFrAxfxszbLRzQONq5+mJejsU5mkZsk6oQsfHDbxzuXbA1u90JTrBCFg1CwlQnh312XePJKx6+IwfZR2cU2xOrkLr26/2wxnelle3e7dncg+TubkDJWJ1KWZ4U4xOXv9+K5u43JoAgNzhHkfpaDPzNQEli3Ey7c/7WF5DnFlMsCEdZMZPRNm6QHq4Lp3/Ym+0+lzCgaXk1r5FLv8653d8fKdF5Msr25bgr1jyEyPCX4h6C6Hxz99MD2SFuikZj6tv2yG2qmshfIybb25jdzoQydtw7H4iLHkeMu0K2Xs5LkcbaITWP5v8NpCdokSbghAd7lGLIxP04z6H4g/s7qhbJb/ORTisU8GLj6HXbMo+0vlWCbMEjDGePbADNu5mawUOIIf+e5GV6PRufjZP//7+Qt3Bq6GnQYTVjnJjysXEsXNst8hjbRMs/xNolFmIZYmh/bg5RSjvMfl36VjlxjALrxEDNoL02ZHIe7ylhYS1cmw1IHQvDg9q9zgrtCN9+U6UgH9wIX+qo6MefNMllcftRD3YZdtnc2sdpdlnFNfRN9zRnVGBLR1Mhde/PRv9+//46U/3r8/5H+IygWBbw36y36WmTBd5s3LN/uWmSab7ce/fuelVodDO6+Oe9xYSTTsUaNRhp3mOMu0o0kEE72RpCuqJU+EWXbNcuTAZgxLNzPZ/gUG696HO06u0zpYyiDhNsxyIFKKXqbcciMBflyi+fTKWaKxSJdlRmKtpzPwF4B4yT3XtDfB0vgc3/V02N67Hpk0Gwmz8wrEDp1Zycr7y0YSxj0BS0ThxlGTCQ6ITmCJ+syAJaUfJ9LUOYqYXfrWefbzW6fP3nLJ4CyYaL2xnekVPkuCOq2BZccQRee4+3lgJnsS/MaET7DOyKUyx2Q46mKp586CSXLfOMWRENdhHjKLJTpj8m7KDP514S4u8lq5tH9WxNJkaFVol4ilEN+9pS2sNc3IsL0PpgCQQFTBJG/4PpCJogUzdbGM9peOpbgpmunHnfcR4qB74RBL1GOaZUV4WlJ6nSbANFGnzKrTGllii2wPf5E3xCPHZ68fn4njiSzBNpWbNfc7zE2wdGsNkizN6/euP3oifDg5jdx2lZDFj6/JlK5518dSefS6LCOhT55hOpYSnDj0lzjAVAoZap39ZXtbn11GEmyTWEKgrqClC79l21PWdDPrtBqWsjBLhda2atuT3mcslELTFp6Hr2qdm5m2XoCls00Xrduo0jh5+NVVbjSFaZWnfVy0wyTuL+3qDXcQjqNyDV0FKOti2Q58cHKjBEs3QdEdkOt3YY4e4Kw6rYYlpkHP0pmj4xp8WjKZ59gKyxBmD8oRMZFLFNmX8dtQ8TxHVSx7+suApQioZYWXBqQFCk0fvY1oyqgulrBiKjnwAYbTWdp5XefL7ZwPVZ3WwdLswxphCUfhFqmLKMrRdglcrUciq9MKWLa101MGiUbuEem0+NEo/TGicMZKVKf9s9SVEyoeFHUgTUapbHIDRuMyEkzad+UY18PShCLJUWTIbDpLiCvb8qwXj/eYGHJ1LGOjSPvDte9OeDQSpbLjHlOiXsAsEx2mF2tWxlL2spR2q8EUvWGUaP2LGfMolQ7PK2XpEmBdmH3L0XNYWpu0kxIClZ14TzWyVLjWgbc2f97dmeRRmuS4cAhHmPajKTLhxuvsL7VSo0P948aRBnrgn8xCiZAq4UAlYdbox7Vk0GG6xr775d5v3j+QZ2+cwIeex1ql31sqty7LsUwHRRPqlFP5kns9hekNTOj0mSduPvqn5+CTpQHJfpTgqx1TPSyAUtExFbWXY1lqr6fQMANkN3554D6lO84oDUozV2b9uEDUulNnc+qUy7LUnjpgmDGWzWKN9357YPrNsSjtb0q55JAZ+LtC4ZgMjwqyLLXXk+osKnI02j1LTp/b9ZveaqLej+Tj3YrMOFy/HJaKzHJplsXsUgURZmh0zb463jq3kZ8gt7OzUjvwsNToEphpdcpjWWyvJ6UiK617WnD/OektrHbTOn3vbuH+UpXb60lFPHkPsPindt1Z573dWo1O+w7LX9SPF30cTFgHMGPIBnYu6eR+dboy8jH8JL5pdVoRyzDxFgc3sAdMOGyEeEiYMoIiR0xRFGdJvNeT0pUKPwNg6Qn7yxBJ5HTgRxsJRVj2uJtpdVqNXQLMLkuLsZeiDEwWp9hEdNOsDbPUFpmCOSxvt3UE0u1nHWniK2RJ8f2Q7XO8OcI8lJHX9FtDaUtf++0vx+71NFkmMFSZMDvfTgEohehx1jJ9alKdsio/dq+nGepM4Y4i6dmihOkd1d9MRpplGZZj99SZI2HMKvhI6ABJ1EMiqMMo99fGx+71NEt2O7Ixlom9u13RYs+4paoy0pj3y3IJu3SbgSqL6W6Q1cAW6UAqBTlfO8iR3jEsCB17Vaq/HLfX0xx5uY3292bzy/eOw/kzsEjlJmyBpguCenNAe+0vx+/1NF2yC/O0nZ1AeWA/cLc+W7ogSBk77c+nxVr+nDqtKFZvJXEr1z/O3ji5d/37zfyZb4/oEpi+0b2k7TSHc5OkdZpQedRtUjzOV8sB1k0ZIKfPPPKLXzXzZycYH7rClC1gNQa0fSV7+svRqpal7vIEJHga3T0wsxOumSv8s73Hfg85TDm4aR41ujXPrNPqWEJIY2cX2umeg3b+7BgA4igSOHpGij34XFXMUqlYfgPt+Q+TtMYIYXtqsFD9BGapZQaAyD8jS1RuAaBt2Tgkcs8gQlmvH29kminkJbBfBmYmL6zcC6EhIqc0U1tgqc0OjFPZqFy/bBcJKQWmStWoA1XNEvtg/xuzIUfqHJNjqcCEUw+daqZ1s1SAyYaJrueE8+B+IAySqr9RT48xK2eprCeWuLdEZ3WDhthxOIacMfbZDEsIvUMOqLeEPwce546Z2gJL1wFGQNggaPzjwkeMVf0sXTweB5Hb/z3M/SVut1GjyvXLD6sfDzUv0TNTG2M5L9EzU1tjuU8xSzrtjeUWtSeW5Ypd5x2Uty9X7DrvoLx9uWLXeQfl7csVu847KG9frth13kF5+3LFrvMOytuXK3add1Devlyx67yD8vblil3nHZS3s5CYJZ2YJZ2YJZ2YJZ2YJZ2YJZ2YJZ2YJZ2YJZ2YJZ2YJZ2YJZ32xvLBixlfzn0hmm2RChZgthlIf6hhjPbF8vKtjC86v2j2l8qEmVVAg3L3/PN2U7DJ2hPLi559JjrSH4L5OKueWQXspPf8S20VNE77YXkhXk19mj+iCfXMK8Ddlt2TYO2tv8xh+cKdvBtyC7D6uEK7VFlV1daSazMTWKb3/BslZonumOd6qmC5UBufaZXLszyHKK6s78krwLyzmSirsMspMVE2S7svy3TVwHJSrJ7J8sHhXKushGXTM2RHfnksz/US4Drjyw2KWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKJWdKpRpafH4rH5qz7KaUKWV688sXXv5+1sLyQ6mN5dftdWN66MtXHsv2Wyr7vvdmbqmZ5+faqWnqlLC9/dyf7Y3rFVSPLxz+5+vuTO9v86FO2y3m6fOsPh+KV9ss+uY3PFPqGZGY5U8ySTvpTaK2YJZ2Y5WbFLOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOnELOn0fzRMqpq3ZBXOAAAAAElFTkSuQmCC" /></p>
<p>The heaviness of the upper tail of the marginal posterior density of
<span class="math inline">\(\sigma_\alpha\)</span> is evident in the
plot on the left. Parameter transformation to <span class="math inline">\((\rho_1, \rho_2)=(\log\sigma_\alpha,
\log\sigma)\)</span> results in a density (in the plot on the right)
from which it is easier to simulate.</p>
<p>We produce some summaries of the posterior sample stored in
<code>coag1</code>. The summaries calculated from <code>coag2</code> are
very similar.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="fl">97.5</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>all1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coag1<span class="sc">$</span>theta_sim_vals, coag1<span class="sc">$</span>sim_vals)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">t</span>(<span class="fu">apply</span>(all1, <span class="dv">2</span>, quantile, <span class="at">probs =</span> probs)), <span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;              2.5%  25%  50%  75% 97.5%</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; theta[1]     58.8 60.4 61.2 62.0  63.8</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; theta[2]     64.0 65.2 65.9 66.5  67.9</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; theta[3]     65.7 67.1 67.8 68.4  69.8</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; theta[4]     59.4 60.5 61.1 61.7  62.9</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; mu           54.7 62.2 64.0 65.7  73.2</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; sigma[alpha]  2.0  3.5  5.0  7.9  27.0</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; sigma         1.8  2.2  2.4  2.7   3.4</span></span></code></pre></div>
<p>These posterior summaries are similar to those presented in Table
11.3 of <span class="citation">Gelman et al. (2014)</span> (where <span class="math inline">\(\sigma_\alpha\)</span> is denoted <span class="math inline">\(\tau\)</span>), which were obtained using Gibbs
sampling.</p>
<p>When the number of groups is small <span class="citation">Gelman
(2006)</span> advocates the use of a half-Cauchy prior for <span class="math inline">\(\sigma_\alpha\)</span>. The code below implements
this using independent half-Cauchy priors for <span class="math inline">\(\sigma_\alpha\)</span> and <span class="math inline">\(\sigma\)</span>, that is, <span class="math display">\[
\pi(\sigma_\alpha, \sigma) \propto
\left(1 + \frac{\sigma_\alpha^2}{A_\alpha^2}\right)^{-1}
\left(1 + \frac{\sigma^2}{A^2}\right)^{-1}, \quad \sigma_\alpha&gt;0, \,
\sigma&gt;0.
\]</span> We choose, somewhat arbitrarily, <span class="math inline">\(\sigma_\alpha = 10\)</span>: in practice <span class="math inline">\(\sigma_\alpha\)</span> should be set by
considering the problem in hand. See <span class="citation">Gelman
(2006)</span> for details. We set <span class="math inline">\(A\)</span>
to be large enough to result in an effectively flat prior for <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>coag3 <span class="ot">&lt;-</span> <span class="fu">hanova1</span>(<span class="at">resp =</span> coagulation[, <span class="dv">1</span>], <span class="at">fac =</span> coagulation[, <span class="dv">2</span>],</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                 <span class="at">param =</span> <span class="st">&quot;original&quot;</span>, <span class="at">prior =</span> <span class="st">&quot;cauchy&quot;</span>, <span class="at">hpars =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">1e6</span>))</span></code></pre></div>
</div>
<div id="appendix" class="section level2">
<h2>Appendix</h2>
<p>Consider the hierarchical 1-way ANOVA model <span class="math display">\[\begin{equation*}
Y_{ij} = \mu + \alpha_i + \epsilon_{ij}, \quad\mbox{for} \,\, i = 1,
\ldots, I, \,
j = 1, \ldots, n_i,  \label{eqn:1way}
\end{equation*}\]</span> where <span class="math inline">\(\alpha_i \sim
N(0, \sigma_\alpha^2)\)</span> and <span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span> and all
random variables are independent. We specify a prior density <span class="math inline">\(\pi(\boldsymbol{\mathbf{\phi}})\)</span> for <span class="math inline">\(\boldsymbol{\mathbf{\phi}} = (\mu, \sigma_\alpha,
\sigma)\)</span>. Let <span class="math inline">\(\boldsymbol{\mathbf{y}} = \{y_{ij}, i=1, \ldots,
I, j = 1, \ldots, n_i\}\)</span> and <span class="math inline">\(\boldsymbol{\mathbf{\alpha}} = (\alpha_1, \ldots,
\alpha_I)\)</span>.</p>
<div id="marginal-posterior-density-of-boldsymbolmathbfphi" class="section level3">
<h3>Marginal posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span></h3>
<p>The joint posterior density of <span class="math inline">\((\boldsymbol{\mathbf{\phi}},
\boldsymbol{\mathbf{\alpha}})\)</span> satisfies <span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\alpha}},\boldsymbol{\mathbf{\phi}}
\mid \boldsymbol{\mathbf{y}}) &amp;\propto
\pi(\boldsymbol{\mathbf{\phi}})
\prod\limits_{i=1}^{I}\prod\limits_{j=1}^{n_i}
\sigma^{-1} \exp \left[-\frac{1}{2\sigma^2}(y_{ij} - \mu -
\alpha_i)^2\right]
\prod_{i=1}^{I}
\sigma_\alpha^{-1}
\exp\left[-\frac{1}{2\sigma^2_\alpha}\alpha_i^2\right]  \nonumber \\
&amp;= \pi(\boldsymbol{\mathbf{\phi}}) \, \sigma^{-n_\cdot} \,
\sigma_\alpha^{-I}
\prod_{i=1}^I \exp \left\{ -\frac12 \left[ \sigma^{-2} \sum_{j=1}^{n_i}
(y_{ij} - \mu - \alpha_i)^2
+\sigma_\alpha^{-2} \alpha_i^2 \right] \right\},
\label{eqn:joint}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(n_\cdot = \sum_{i=1}^{I}
n_i\)</span>. Let <span class="math inline">\(\bar{y}_{i\cdot} = (1/n_i)
\sum_{j=1}^{n_i} y_{ij}\)</span>. Completing the square in <span class="math inline">\(\alpha_i\)</span> in the term in square brackets
gives <span class="math display">\[\begin{align*}
&amp;\sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \mu - \alpha_i)^2 +
\sigma_\alpha^{-2} \alpha_i^2 \\
&amp;=
\sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \mu)^2
- 2 n_i \sigma^{-2} (\bar{y}_{i\cdot} - \mu) \alpha_i + (n_i \sigma^{-2}
+ \sigma_\alpha^{-2})\alpha_i^2 \\
&amp;= (\sigma^{-2} n_i + \sigma_{\alpha}^{-2})
\left[ \alpha_i - \frac{n_i \sigma^{-2} (\bar{y}_{i\cdot} - \mu)}{n_i
\sigma^{-2} + \sigma_{\alpha}^{-2}} \right]^2
- \frac{n_i^2 \sigma^{-4} (\bar{y}_{i\cdot} - \mu)^2}{n_i \sigma^{-2} +
\sigma_{\alpha}^{-2}}
+ \sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \mu)^2 \\
&amp;= a_i (\alpha_i - b_i / a_i)^2 + c_i - b_i^2 / a_i,
\end{align*}\]</span> where <span class="math inline">\(a_i = n_i
\sigma^{-2} + \sigma_\alpha^{-2}, b_i = n_i \sigma^{-2}
(\bar{y}_{i\cdot} - \mu)\)</span> and <span class="math inline">\(c_i =
\sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \mu)^2\)</span>. Therefore, <span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\phi}}, \boldsymbol{\mathbf{\alpha}} \mid
\boldsymbol{\mathbf{y}})
&amp;\propto
\pi(\boldsymbol{\mathbf{\phi}}) \, \sigma^{-n_\cdot} \,
\sigma_\alpha^{-I}
\prod_{i=1}^I \exp\left[ -\frac12 \left( c_i - b_i ^ 2 / a_i \right)
\right]
\exp\left[ -\frac{1}{2a_i^{-1}} \left( \alpha_i - b_i / a_i \right)^2
\right]. \\
\end{align*}\]</span></p>
<p>The marginal posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span> is given by
<span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\phi}} \mid \boldsymbol{\mathbf{y}})
&amp;=
\int_{-\infty}^{\infty}\cdots\int_{-\infty}^{\infty}
\pi(\boldsymbol{\mathbf{\alpha}}, \boldsymbol{\mathbf{\phi}}
\mid \boldsymbol{\mathbf{y}}) {\rm ~d}\alpha_1 \cdots {\rm ~d}\alpha_I
\\
&amp;\propto
\pi(\boldsymbol{\mathbf{\phi}}) \, \sigma^{-n_\cdot} \,
\sigma_\alpha^{-I}
\prod_{i=1}^I \exp\left[ -\frac12 \left( c_i - b_i ^ 2 / a_i \right)
\right]
\int_{-\infty}^{\infty} \exp\left[ -\frac{1}{2a_i^{-1}} \left( \alpha_i
- b_i / a_i \right)^2 \right] {\rm ~d}\alpha_i \\
&amp;\propto
\pi(\boldsymbol{\mathbf{\phi}}) \, \sigma^{-n_\cdot} \,
\sigma_\alpha^{-I}
\prod_{i=1}^I a_i^{-1/2} \exp\left[ -\frac12 \left( c_i - b_i ^ 2 / a_i
\right) \right] \\
&amp;\propto
\pi(\boldsymbol{\mathbf{\phi}}) \, \sigma^{I-n_\cdot} \,
\prod_{i=1}^I (\sigma_\alpha^2+\sigma^2/n_i)^{-1/2} \exp\left[ -\frac12
\left( c_i - b_i ^2 / a_i \right) \right].
\end{align*}\]</span> Manipulating <span class="math inline">\(c_i - b_i
^2 / a_i\)</span> gives <span class="math display">\[\begin{align*}
c_i - b_i ^ 2 / a_i
  &amp;= \sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \mu)^2
   - \frac{n_i^2 \sigma^{-4} (\bar{y}_{i\cdot} - \mu)^2}
  {n_i \sigma^{-2} + \sigma_\alpha^{-2}} \\
  &amp;= \sigma^{-2} \left[ \sum_{j=1}^{n_i} (y_{ij} -
\bar{y}_{i\cdot})^2
   + n_i (\bar{y}_{i\cdot} - \mu)^2 \right]
   - \frac{n_i^2 \sigma^{-4} (\bar{y}_{i\cdot} - \mu)^2}
  {n_i \sigma^{-2} + \sigma_\alpha^{-2}} \\
  &amp;= \sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \bar{y}_{i\cdot})^2 +
   \frac{\left[ n_i \sigma^{-2} \left(n_i
\sigma^{-2}+\sigma_\alpha^{-2}\right)
    - n_i^2 \sigma^{-4} \right]}{n_i \sigma^{-2} + \sigma_\alpha^{-2}}
    (\bar{y}_{i\cdot} - \mu)^2 \\
  &amp;= \sigma^{-2} \sum_{j=1}^{n_i} (y_{ij} - \bar{y}_{i\cdot})^2
   + \frac{1}{\sigma_\alpha^2 + \sigma^2 / n_i} (\mu -
\bar{y}_{i\cdot})^2.
\end{align*}\]</span> Therefore, the joint posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span> satisfies
<span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\phi}} \mid \boldsymbol{\mathbf{y}})
&amp;\propto
\pi(\boldsymbol{\mathbf{\phi}}) \,
\sigma^{I-n_\cdot} \,
\exp\left( -\frac{1}{2\sigma^{2}} S \right)
\prod_{i=1}^I \sigma_i^{-1}
\exp\left[ -\frac{1}{2 \sigma_i^2} (\mu - \mu_i)^2 \right],
\end{align*}\]</span> where <span class="math inline">\(S = \sum_{i=1}^I
\sum_{j=1}^{n_i} (y_{ij} - \bar{y}_{i\cdot})^2\)</span>, <span class="math inline">\(\mu_i = \bar{y}_{i\cdot}\)</span> and <span class="math inline">\(\sigma_i^2 = \sigma_\alpha^2 +
\sigma^2/n_i\)</span>.</p>
<div id="a-special-case" class="section level4">
<h4>A special case</h4>
<p>Suppose that a <span class="math inline">\(N(\mu_0,
\sigma_0^2\)</span>) prior distribution is specified for <span class="math inline">\(\mu\)</span>, so that <span class="math inline">\(\pi(\mu) \propto \exp[-\sigma_0^{-2}(\mu-\mu_0)^2)
/ 2]\)</span> and that <span class="math inline">\(\mu\)</span> and
<span class="math inline">\((\sigma_\alpha, \sigma)\)</span> are
independent <em>a priori</em>. We derive the marginal posterior density
for <span class="math inline">\((\sigma_\alpha, \sigma)\)</span> in this
case and the conditional posterior density of <span class="math inline">\(\mu\)</span> given <span class="math inline">\((\sigma_\alpha, \sigma)\)</span>. The joint
posterior density for <span class="math inline">\((\mu, \sigma_\alpha,
\sigma)\)</span> satisfies <span class="math display">\[\begin{align*}
\pi(\mu, \sigma_\alpha, \sigma \mid \boldsymbol{\mathbf{y}})
&amp;\propto \pi(\mu) \, \pi(\sigma_\alpha, \sigma) \,
\sigma^{I-n_\cdot} \,
\exp\left( -\frac{1}{2\sigma^{2}} S \right)
\prod_{i=1}^I \sigma_i^{-1}
\exp\left[ -\frac{1}{2 \sigma_i^2} (\mu - \mu_i)^2 \right], \\
&amp;=
\pi(\sigma_\alpha, \sigma) \,
\sigma^{I-n_\cdot} \,
\exp\left( -\frac{1}{2\sigma^{2}} S \right)
\left(\prod_{i=1}^I \sigma_i^{-1} \right)
\exp\left[
-\frac{1}{2} \sum_{i=0}^{I} \sigma_i^{-2} (\mu - \mu_i)^2
\right],
\end{align*}\]</span> Completing the square in <span class="math inline">\(\mu\)</span> in <span class="math inline">\(\sum_{i=0}^{I} \sigma_i^{-2} (\mu -
\mu_i)^2\)</span> gives <span class="math display">\[\begin{align*}
\sum_{i=0}^{I} \sigma_i^{-2} (\mu - \mu_i)^2
&amp;=
\sum_{i=0}^{I} \sigma_i^{-2} (\mu^2 - 2 \mu \mu_i + \mu_i^2) \\
&amp;=
\mu^2 \sum_{i=0}^{I} \sigma_i^{-2}
- 2 \mu \sum_{i=0}^{I} \mu_i \sigma_i^{-2}
+ \sum_{i=0}^{I} \mu_i ^2 \sigma_i^{-2} \\
&amp;=
\left(\sum_{i=0}^{I} \sigma_i^{-2} \right)
\left( \mu - \frac{\sum_{i=0}^{I} \mu_i \sigma_i^{-2}}
{\sum_{i=0}^{I} \sigma_i^{-2}} \right)^{\!\!2}
- \frac{\left( \sum_{i=0}^{I} \mu_i \sigma_i^{-2} \right)^2}
{\sum_{i=0}^{I} \sigma_i^{-2}}
+ \sum_{i=0}^{I} \mu_i^{2} \sigma_i^{-2} \\
&amp;=
S_0 (\mu - S_1 S_0^{-1})^2
- S_1^2 S_0^{-1} + S_2, \\
\end{align*}\]</span> where <span class="math inline">\(S_j =
\sum_{i=0}^{I} \mu_i^{j} \sigma_i^{-2}, \, j = 0, 1, 2\)</span>.
Therefore, <span class="math display">\[\begin{align*}
\pi(\sigma_\alpha, \sigma \mid \boldsymbol{\mathbf{y}})
&amp;=
\int_{-\infty}^{\infty}
\pi(\mu, \sigma_\alpha, \sigma \mid \boldsymbol{\mathbf{y}})
{\rm ~d}\mu \\
&amp;\propto
\pi(\sigma_\alpha, \sigma) \,
\sigma^{I-n_\cdot} \,
\exp\left\{ -\frac{1}{2\sigma^{2}} S \right\}
\left(\prod_{i=1}^I \sigma_i^{-1} \right)
\exp\left( \frac12 S_1^2 S_0^{-1} - \frac12 S_2 \right) \\
&amp;\phantom{\propto} \times
\int_{-\infty}^{\infty}
\exp\left\{ -\frac{1}{2 S_0^{-1}} (\mu - S_1 S_0^{-1})^2
\right\}
{\rm ~d}\mu \\
&amp;\propto
\pi(\sigma_\alpha, \sigma) \,
\sigma^{I-n_\cdot} \,
\exp\left\{ -\frac{1}{2\sigma^{2}} S \right\}
\left(\prod_{i=1}^I \sigma_i^{-1} \right)
\exp\left( \frac12 S_1^2 S_0^{-1} - \frac12 S_2 \right)
S_0^{-1/2}.
\end{align*}\]</span></p>
<p>Retaining only the terms in <span class="math inline">\(\pi(\mu,
\sigma_\alpha, \sigma \mid \boldsymbol{\mathbf{y}})\)</span> that
involve <span class="math inline">\(\mu\)</span> gives <span class="math display">\[\begin{align*}
\pi(\mu \mid \sigma_\alpha, \sigma, \boldsymbol{\mathbf{y}})
&amp;\propto
\exp\left[ -\frac{1}{2 S_0^{-1}} (\mu - S_1 / S_0)^2 \right].
\end{align*}\]</span> Therefore, <span class="math inline">\(\mu \mid
\sigma_\alpha, \sigma, \boldsymbol{\mathbf{y}} \sim N(S_1 S_0^{-1},
S_0^{-1})\)</span>.</p>
</div>
</div>
<div id="the-conditional-posterior-density-of-boldsymbolmathbftheta-given-boldsymbolmathbfphi" class="section level3">
<h3>The conditional posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\theta}}\)</span> given <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span></h3>
<p>The conditional posterior density of <span class="math inline">\(\boldsymbol{\mathbf{\alpha}}\)</span> given <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span> satisfies
<span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\alpha}} \mid \boldsymbol{\mathbf{\phi}},
\boldsymbol{\boldsymbol{\mathbf{y}}})
&amp;\propto \prod_{i=1}^I \exp\left[ -\frac{1}{2a_i^{-1}} \left(
\alpha_i - b_i / a_i \right)^2 \right],
\end{align*}\]</span> because these are the only terms in <span class="math inline">\(\pi (\boldsymbol{\mathbf{\phi}},
\boldsymbol{\mathbf{\alpha}} \mid \boldsymbol{\mathbf{y}})\)</span> that
involve <span class="math inline">\(\alpha_i, i = 1, \ldots, I\)</span>.
Therefore, conditional on <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span>, <span class="math inline">\(\alpha_1, \ldots, \alpha_I\)</span> are
independent <em>a posteriori</em> and <span class="math inline">\(\alpha_i \mid \boldsymbol{\mathbf{\phi}},
\boldsymbol{\mathbf{y}} \sim N(b_i a_i^{-1}, a_i^{-1})\)</span>, where
<span class="math display">\[\begin{align*}
b_i a_i^{-1} &amp;=
\frac{\sigma_\alpha^2 \, (\bar{y}_{i\cdot} - \mu)}
{\sigma_\alpha^{2} + \sigma^2 / n_i} \\
a_i^{-1} &amp;= \frac{\sigma_\alpha^2 \, \sigma^2 / n_i}
{\sigma_\alpha^{2} + \sigma^2 / n_i}. \\
\end{align*}\]</span> Noting that <span class="math inline">\(\theta_i =
\mu + \alpha_i\)</span> gives <span class="math inline">\(\theta_i \mid
\boldsymbol{\mathbf{\phi}}, \boldsymbol{\mathbf{y}} \sim
N(\hat{\theta}_i, a_i^{-1})\)</span>, where <span class="math display">\[\begin{align*}
\hat{\theta}_i &amp;=
\frac{\bar{y}_{i\cdot} \sigma_\alpha^2 + \mu \, \sigma ^ 2 / n_i}
{\sigma_\alpha^{2} + \sigma^2 / n_i}. \\
\end{align*}\]</span></p>
</div>
<div id="factorisations-for-simulation" class="section level3">
<h3>Factorisations for simulation</h3>
<p>In the most general case considered here the factorisation <span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\phi}}, \boldsymbol{\mathbf{\alpha}} \mid
\boldsymbol{\mathbf{y}})
&amp;= \pi(\boldsymbol{\mathbf{\phi}} \mid \boldsymbol{\mathbf{y}})
\, \prod_{i=1}^{I} \pi(\alpha_i \mid \boldsymbol{\mathbf{\phi}},
\boldsymbol{\boldsymbol{\mathbf{y}}})
\end{align*}\]</span> means that we can simulate first from the
three-dimensional <span class="math inline">\(\pi(\boldsymbol{\mathbf{\phi}}, \mid
\boldsymbol{\mathbf{y}})\)</span> and then, conditional on the value of
<span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span>,
simulate independently from each of the normal distributions of <span class="math inline">\(\alpha_i \mid \boldsymbol{\mathbf{\phi}},
\boldsymbol{\boldsymbol{\mathbf{y}}}\)</span>.</p>
<p>In the special case detailed above the factorisation becomes <span class="math display">\[\begin{align*}
\pi(\boldsymbol{\mathbf{\phi}}, \boldsymbol{\mathbf{\alpha}} \mid
\boldsymbol{\mathbf{y}})
&amp;= \pi(\sigma_\alpha, \sigma \mid \boldsymbol{\mathbf{y}})
\, \pi(\mu \mid \sigma_\alpha, \sigma, \boldsymbol{\mathbf{y}})
\, \prod_{i=1}^{I} \pi(\alpha_i \mid \boldsymbol{\mathbf{\phi}},
\boldsymbol{\boldsymbol{\mathbf{y}}}).
\end{align*}\]</span> Therefore, the first stage can be performed by
simulating from the two-dimensional <span class="math inline">\(\pi(\sigma_\alpha, \sigma \mid
\boldsymbol{\mathbf{y}})\)</span> and then, conditional on the value of
<span class="math inline">\((\sigma_\alpha, \sigma)\)</span>, from the
normal distribution of <span class="math inline">\(\mu \mid
\sigma_\alpha, \sigma, \boldsymbol{\mathbf{y}}\)</span>.</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gelman2006" class="csl-entry">
Gelman, A. 2006. <span>“Prior Distributions for Variance Parameters in
Hierarchical Models.”</span> <em><span>B</span>ayesian Analysis</em> 1
(3): 515–33. <a href="https://doi.org/10.1214/06-BA117A">https://doi.org/10.1214/06-BA117A</a>.
</div>
<div id="ref-BDA2014" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D.
B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. Florida, USA:
Chapman &amp; Hall / CRC. <a href="http://www.stat.columbia.edu/~gelman/book/">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-rust" class="csl-entry">
Northrop, P. J. 2017. <em><span class="nocase">r</span>ust:
Ratio-of-Uniforms Simulation with Transformation</em>. <a href="https://CRAN.R-project.org/package=rust">https://CRAN.R-project.org/package=rust</a>.
</div>
<div id="ref-NC2014" class="csl-entry">
Northrop, P. J., and R. E. Chandler. 2014. <span>“Quantifying Sources of
Uncertainty in Projections of Future Climate”</span> 27: 8793–8808. <a href="https://doi.org/10.1175/JCLI-D-14-00265.1">https://doi.org/10.1175/JCLI-D-14-00265.1</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
